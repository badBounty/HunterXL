#!/bin/bash

#vulners.sh  subdomains-webapp.txt spidering.txt http://pingb.in/p/03e8fef1e7d875c304b342e0b02
#->
#openredirect.csv
#sqlmap.csv
#testssl.csv
#nikto.csv



#nuclei.csv
#retirejs.csv
#dalfox.csv


#Buscamos vuls en archivos JS

websites=$1

cd outputs

#ZAP
CSVHEADERS=0
while read subdomain; do
	
	echo "--------------Init ZAP for: $subdomain"
	
	if [[ $(cat /proc/version) == *"WSL"* ]]; then 
		docker.exe run -v $(wslpath -w .):/zap/wrk owasp/zap2docker-stable zap-baseline.py -t "$subdomain" -s -j -T 10 -m 5 -a -J zap.json
	else
	docker run -v $(pwd):/zap/wrk owasp/zap2docker-stable zap-baseline.py -t "$subdomain" -s -j -T 10 -m 5 -a -J zap.json
	fi
	
	if [ $CSVHEADERS -eq 1 ] then
		echo "--------------Init CSV Zap"
		python3 ../zap-converter-init.py
		CSVHEADERS=1
	#fi
	
	python3 ../zap-converter.py
	
	rm zap.json
	
done < ./"$websites"

#Volvemos a la carpeta del repositorio
cd ..